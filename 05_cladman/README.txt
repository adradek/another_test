В условиях задачи присутствует несколько неопределенностей, которые я буду трактовать "в свою пользу",
отдавая, при этом, отчет, что в реальных условиях, неопределенности лучше прояснять в разговоре

1. Стол - это точка в левом нижнем углу зеленого контура
2. Нет разницы, с какой стороны подходить к стеллажу
3. Перемещение сотрудника дискретно: один шаг равняется ширине полки (хотя, решение должно работать и без этого условия)
4. Достаточно встать напротив середины стеллажа, и кладовщик дотягивается до любой его ячейки
5. От стола до ближайшего стеллажа - один шаг "наверх" (один шаг по вертикальной зеленой линии)

В рассуждениях я буду нумеровать проходы и ряды стеллажей слева направо, начиная с 1. Пусть Ms -
максимальный номер ряда стеллажей, с которого надо забрать товар

- Тогда нет необходимости делать больше шагов по горизонтали, чем 2 * (Ms - 1). То есть, если надо
  обойти ячейки только первого стеллажа, то по горизонтали мы вообще не двигаемся, просто идем вверх и
  возвращаемся

- Первый вертикальный путь имеет смысл использовать, только если все нужные ячейки находятся на первом ряду стеллажей
  Иначе, кладовщик может сразу идти на второй путь, откуда есть доступ к 1 и ко 2 рядам стеллажей

- существует маршрут, который гарантированно идет через все стеллажи - это обойти ряд стеллажей 2 по (или против)
  часовой стрелки, его длина составляет 4 шага по горизонтали (два влево, два вправо) и 1402 шага по вертикали,
  итого 1406 шагов. Нет смысла строить маршрут длиннее этого

Итак, алгоритм:

1. Если надо посетить только первый ряд стеллажей, то идем вверх по первому пути до последней интересующей
   нас ячейки, затем возвращаемся

2. Если требуется посетить только первый и второй ряды, то действуем в том же ключе, только по второму
   пути. Это потребует два шага по горизонтали

3. Если первый ряд нас не интересует, а третий и (опционально) второй - да, то поступаем точно так же,
   но двигаемся по третьему пути

4. Если нам надо собрать товары и с первого и с третьего рядов, то возникает два варианта маршрута:

   а) делать тот самый гарантированный маршрут (в 1406 шагов) - вокруг второго ряда стеллажей
   б) подняться до высочайшей необходимой точки по второму пути (x шагов вверх), вернуться вниз и затем подняться до
      высочайшей необходимой точки по третьему пути (y шагов вверх)

   Опуская нехитрые рассчеты, делюсь выводом, что выбор в пользу гарантированного маршрута (а) надо делать,
   если x + y >= 701, где 701 шаг - это длинна вертикальных путей.
